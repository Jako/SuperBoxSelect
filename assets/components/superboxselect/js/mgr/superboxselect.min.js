/*!
 * SuperBoxSelect - Advanced Listbox/Resource List Template Variable Type
 * Version: 2.3.2
 * Build date: 2019-04-26
 */

!function(e){"use strict";"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&void 0!==module.exports?module.exports=e():window.Sortable=e()}(function(){"use strict";if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var U,q,h,u,j,K,p,I,O,A,G,n,Z,Q,a,s,c,f,N,J,$,ee,te,oe,g,ne,P=[],H=!1,m=!1,ie=!1,d=[],re=!1,le=!1,v=[],i=/\s+/g,ae="Sortable"+(new Date).getTime(),b=window,se=b.document,x=b.parseInt,ce=b.setTimeout,t=b.jQuery||b.Zepto,o=b.Polymer,r={capture:!1,passive:!1},de=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),y=!!navigator.userAgent.match(/Edge/i),_=!!navigator.userAgent.match(/firefox/i),S=!(!navigator.userAgent.match(/safari/i)||navigator.userAgent.match(/chrome/i)||navigator.userAgent.match(/android/i)),w=!!navigator.userAgent.match(/iP(ad|od|hone)/i),D=y||de?"cssFloat":"float",l="draggable"in se.createElement("div"),T=function(){if(de)return!1;var e=se.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}(),pe=!1,E=!1,ue=Math.abs,C=Math.min,B=Math.max,k=[],M=function(e,t){var o=Se(e),n=x(o.width)-x(o.paddingLeft)-x(o.paddingRight)-x(o.borderLeftWidth)-x(o.borderRightWidth),i=ke(e,0,t),r=ke(e,1,t),l=i&&Se(i),a=r&&Se(r),s=l&&x(l.marginLeft)+x(l.marginRight)+Re(i).width,c=a&&x(a.marginLeft)+x(a.marginRight)+Re(r).width;if("flex"===o.display)return"column"===o.flexDirection||"column-reverse"===o.flexDirection?"vertical":"horizontal";if("grid"===o.display)return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&"none"!==l.float){var d="left"===l.float?"left":"right";return!r||"both"!==a.clear&&a.clear!==d?"horizontal":"vertical"}return i&&("block"===l.display||"flex"===l.display||"table"===l.display||"grid"===l.display||n<=s&&"none"===o[D]||r&&"none"===o[D]&&n<s+c)?"vertical":"horizontal"},X=function(e,t){if(!e||!e.getBoundingClientRect)return Y();var o=e,n=!1;do{if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var i=Se(o);if(o.clientWidth<o.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||o.clientHeight<o.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!o||!o.getBoundingClientRect||o===se.body)return Y();if(n||t)return o;n=!0}}}while(o=o.parentNode);return Y()},Y=function(){return de?se.documentElement:se.scrollingElement},he=function(e,t,o){e.scrollLeft+=t,e.scrollTop+=o},L=Pe(function(o,e,t,n){if(e.scroll){var i=t?t[ae]:window,r=e.scrollSensitivity,l=e.scrollSpeed,a=o.clientX,s=o.clientY,c=Y(),d=!1;O!==t&&(R(),I=e.scroll,A=e.scrollFn,!0===I&&(I=X(t,!0),O=I));var p=0,u=I;do{var h,f,g,m,v,b,x,y,_,S=u,w=Re(S),D=w.top,T=w.bottom,E=w.left,C=w.right,B=w.width,k=w.height;if(h=S.scrollWidth,f=S.scrollHeight,g=Se(S),y=S.scrollLeft,_=S.scrollTop,x=S===c?(b=B<h&&("auto"===g.overflowX||"scroll"===g.overflowX||"visible"===g.overflowX),k<f&&("auto"===g.overflowY||"scroll"===g.overflowY||"visible"===g.overflowY)):(b=B<h&&("auto"===g.overflowX||"scroll"===g.overflowX),k<f&&("auto"===g.overflowY||"scroll"===g.overflowY)),m=b&&(ue(C-a)<=r&&y+B<h)-(ue(E-a)<=r&&!!y),v=x&&(ue(T-s)<=r&&_+k<f)-(ue(D-s)<=r&&!!_),!P[p])for(var M=0;M<=p;M++)P[M]||(P[M]={});P[p].vx==m&&P[p].vy==v&&P[p].el===S||(P[p].el=S,P[p].vx=m,P[p].vy=v,clearInterval(P[p].pid),!S||0==m&&0==v||(d=!0,P[p].pid=setInterval(function(){n&&0===this.layer&&(ve.active._emulateDragOver(!0),ve.active._onTouchMove(N,!0));var e=P[this.layer].vy?P[this.layer].vy*l:0,t=P[this.layer].vx?P[this.layer].vx*l:0;"function"==typeof A&&"continue"!==A.call(i,t,e,o,N,P[this.layer].el)||he(P[this.layer].el,t,e)}.bind({layer:p}),24))),p++}while(e.bubbleScroll&&u!==c&&(u=X(u,!1)));H=d}},30),R=function(){P.forEach(function(e){clearInterval(e.pid)}),P=[]},F=function(e){function s(l,a){return function(e,t,o,n){var i=e.options.group.name&&t.options.group.name&&e.options.group.name===t.options.group.name;if(null==l&&(a||i))return!0;if(null==l||!1===l)return!1;if(a&&"clone"===l)return l;if("function"==typeof l)return s(l(e,t,o,n),a)(e,t,o,n);var r=(a?e:t).options.group.name;return!0===l||"string"==typeof l&&l===r||l.join&&-1<l.indexOf(r)}}var t={},o=e.group;o&&"object"==typeof o||(o={name:o}),t.name=o.name,t.checkPull=s(o.pull,!0),t.checkPut=s(o.put),t.revertClone=o.revertClone,e.group=t},V=function(e){U&&U.parentNode&&U.parentNode[ae]&&U.parentNode[ae]._computeIsAligned(e)},fe=function(e,t){for(var o=t;!o[ae];)o=o.parentNode;return e===o},ge=function(e,t,o){for(var n=e.parentNode;n&&!n[ae];)n=n.parentNode;n&&n[ae][o](He(t,{artificialBubble:!0}))},W=function(){!T&&h&&Se(h,"display","none")},z=function(){!T&&h&&Se(h,"display","")};se.addEventListener("click",function(e){if(ie)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ie=!1},!0);var me,e=function(e){if(e=e.touches?e.touches[0]:e,U){var t=function(e,t){for(var o=0;o<d.length;o++)if(!Me(d[o])){var n=Re(d[o]),i=d[o][ae].options.emptyInsertThreshold,r=e>=n.left-i&&e<=n.right+i,l=t>=n.top-i&&t<=n.bottom+i;if(r&&l)return d[o]}}(e.clientX,e.clientY);t&&t[ae]._onDragOver({clientX:e.clientX,clientY:e.clientY,target:t,rootEl:t})}};function ve(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(e);this.el=e,this.options=t=He({},t),e[ae]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return M(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:x(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==ve.supportPointer&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var n in o)!(n in t)&&(t[n]=o[n]);for(var i in F(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&l,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?xe(e,"pointerdown",this._onTapStart):(xe(e,"mousedown",this._onTapStart),xe(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(xe(e,"dragover",this),xe(e,"dragenter",this)),d.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[])}function be(e,t,o,n){if(e){o=o||se;do{if(null!=t&&(">"===t[0]&&e.parentNode===o&&Ne(e,t.substring(1))||Ne(e,t))||n&&e===o)return e;if(e===o)break}while(e=(i=e).host&&i!==se&&i.host.nodeType?i.host:i.parentNode)}var i;return null}function xe(e,t,o){e.addEventListener(t,o,r)}function ye(e,t,o){e.removeEventListener(t,o,r)}function _e(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(i," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(i," ")}}function Se(e,t,o){var n=e&&e.style;if(n){if(void 0===o)return se.defaultView&&se.defaultView.getComputedStyle?o=se.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),void 0===t?o:o[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=o+("string"==typeof o?"":"px")}}function we(e){var t="";do{var o=Se(e,"transform");o&&"none"!==o&&(t=o+" "+t)}while(e=e.parentNode);return window.DOMMatrix?new DOMMatrix(t):window.WebKitCSSMatrix?new WebKitCSSMatrix(t):window.CSSMatrix?new CSSMatrix(t):void 0}function De(e,t,o){if(e){var n=e.getElementsByTagName(t),i=0,r=n.length;if(o)for(;i<r;i++)o(n[i],i);return n}return[]}function Te(e,t,o,n,i,r,l,a,s){var c,d=(e=e||t[ae]).options,p="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||de||y?(c=se.createEvent("Event")).initEvent(o,!0,!0):c=new CustomEvent(o,{bubbles:!0,cancelable:!0}),c.to=i||t,c.from=r||t,c.item=n||t,c.clone=u,c.oldIndex=l,c.newIndex=a,c.originalEvent=s,c.pullMode=Q?Q.lastPutMode:void 0,t&&t.dispatchEvent(c),d[p]&&d[p].call(e,c)}function Ee(e,t,o,n,i,r,l,a){var s,c,d=e[ae],p=d.options.onMove;return!window.CustomEvent||de||y?(s=se.createEvent("Event")).initEvent("move",!0,!0):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=t,s.from=e,s.dragged=o,s.draggedRect=n,s.related=i||t,s.relatedRect=r||Re(t),s.willInsertAfter=a,s.originalEvent=l,e.dispatchEvent(s),p&&(c=p.call(d,s,l)),c}function Ce(e){e.draggable=!1}function Be(){pe=!1}function ke(e,t,o){for(var n=0,i=0,r=e.children;i<r.length;){if("none"!==r[i].style.display&&r[i]!==h&&r[i]!==U&&be(r[i],o.draggable,e,!1)){if(n===t)return r[i];n++}i++}return null}function Me(e){for(var t=e.lastElementChild;t&&(t===h||"none"===t.style.display);)t=t.previousElementSibling;return t||null}function Ie(e){return Ae(U)<Ae(e)?1:-1}function Oe(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Ae(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e&&(e=e.previousElementSibling);)"TEMPLATE"!==e.nodeName.toUpperCase()&&e!==u&&o++;return o}function Ne(e,t){if(e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}function Pe(o,n){return function(){if(!me){var e=arguments,t=this;me=ce(function(){1===e.length?o.call(t,e[0]):o.apply(t,e),me=void 0},n)}}}function He(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function Xe(e){return o&&o.dom?o.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}function Ye(e){return ce(e,0)}function Le(e){return clearTimeout(e)}function Re(e,t,o,n){if(e.getBoundingClientRect||e===b){var i,r,l,a,s,c,d;if(d=e!==b&&e!==Y()?(r=(i=e.getBoundingClientRect()).top,l=i.left,a=i.bottom,s=i.right,c=i.height,i.width):(l=r=0,a=window.innerHeight,s=window.innerWidth,c=window.innerHeight,window.innerWidth),n&&e!==b&&(o=o||e.parentNode,!de))do{if(o&&o.getBoundingClientRect&&"none"!==Se(o,"transform")){var p=o.getBoundingClientRect();r-=p.top+x(Se(o,"border-top-width")),l-=p.left+x(Se(o,"border-left-width")),a=r+i.height,s=l+i.width;break}}while(o=o.parentNode);if(t&&e!==b){var u=we(o||e),h=u&&u.a,f=u&&u.d;u&&(a=(r/=f)+(c/=f),s=(l/=h)+(d/=h))}return{top:r,left:l,bottom:a,right:s,width:d,height:c}}}function Fe(e,t){for(var o=X(e,!0),n=Re(e)[t];o;){var i=Re(o)[t];if(!("top"===t||"left"===t?i<=n:n<=i))return o;if(o===Y())break;o=X(o,!1)}return!1}function Ve(e){var t=0,o=0,n=Y();if(e)do{var i=we(e),r=i.a,l=i.d;t+=e.scrollLeft*r,o+=e.scrollTop*l}while(e!==n&&(e=e.parentNode));return[t,o]}return xe(se,"dragover",e),xe(se,"mousemove",e),xe(se,"touchmove",e),ve.prototype={constructor:ve,_computeIsAligned:function(e){var t;if(h&&!T?(W(),t=se.elementFromPoint(e.clientX,e.clientY),z()):t=e.target,t=be(t,this.options.draggable,this.el,!1),!E&&U&&U.parentNode===this.el){for(var o,n,i,r,l,a,s,c,d=this.el.children,p=0;p<d.length;p++)be(d[p],this.options.draggable,this.el,!1)&&d[p]!==t&&(d[p].sortableMouseAligned=(o=e.clientX,n=e.clientY,i=d[p],r=this._getDirection(e,null),this.options,void 0,l=Re(i),a="vertical"===r?l.left:l.top,s="vertical"===r?l.right:l.bottom,a<(c="vertical"===r?o:n)&&c<s));be(t,this.options.draggable,this.el,!0)||($=null),E=!0,ce(function(){E=!1},30)}},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,U):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t,o=this,n=this.el,i=this.options,r=i.preventOnFilter,l=e.type,a=e.touches&&e.touches[0],s=(a||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,d=i.filter;if(function(e){k.length=0;var t=e.getElementsByTagName("input"),o=t.length;for(;o--;){var n=t[o];n.checked&&k.push(n)}}(n),(!de||e.artificialBubble||fe(n,s))&&!U&&!(/mousedown|pointerdown/.test(l)&&0!==e.button||i.disabled||c.isContentEditable))if(s=be(s,i.draggable,n,!1)){if(p!==s){if(t=Ae(s,i.draggable),"function"==typeof d){if(d.call(this,e,s,this))return Te(o,c,"filter",s,n,n,t),void(r&&e.cancelable&&e.preventDefault())}else if(d&&(d=d.split(",").some(function(e){if(e=be(c,e.trim(),n,!1))return Te(o,e,"filter",s,n,n,t),!0})))return void(r&&e.cancelable&&e.preventDefault());i.handle&&!be(c,i.handle,n,!1)||this._prepareDragStart(e,a,s,t)}}else de&&ge(n,e,"_onTapStart")}},_handleAutoScroll:function(t,o){if(U&&this.options.scroll){var n=t.clientX,i=t.clientY,e=se.elementFromPoint(n,i),r=this;if(o||y||de||S){L(t,r.options,e,o);var l=X(e,!0);!H||a&&n===s&&i===c||(a&&clearInterval(a),a=setInterval(function(){if(U){var e=X(se.elementFromPoint(n,i),!0);e!==l&&(l=e,R(),L(t,r.options,l,o))}},10),s=n,c=i)}else{if(!r.options.bubbleScroll||X(e,!0)===Y())return void R();L(t,r.options,X(e,!1),!1)}}},_prepareDragStart:function(e,t,o,n){var i,r=this,l=r.el,a=r.options,s=l.ownerDocument;o&&!U&&o.parentNode===l&&(j=l,q=(U=o).parentNode,K=U.nextSibling,p=o,Z=a.group,G=n,f={target:U,clientX:(t||e).clientX,clientY:(t||e).clientY},this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,U.style["will-change"]="all",U.style.transition="",U.style.transform="",i=function(){r._disableDelayedDragEvents(),!_&&r.nativeDraggable&&(U.draggable=!0),r._triggerDragStart(e,t),Te(r,j,"choose",U,j,j,G),_e(U,a.chosenClass,!0)},a.ignore.split(",").forEach(function(e){De(U,e.trim(),Ce)}),a.supportPointer?xe(s,"pointerup",r._onDrop):(xe(s,"mouseup",r._onDrop),xe(s,"touchend",r._onDrop),xe(s,"touchcancel",r._onDrop)),_&&this.nativeDraggable&&(this.options.touchStartThreshold=4,U.draggable=!0),!a.delay||this.nativeDraggable&&(y||de)?i():(xe(s,"mouseup",r._disableDelayedDrag),xe(s,"touchend",r._disableDelayedDrag),xe(s,"touchcancel",r._disableDelayedDrag),xe(s,"mousemove",r._delayedDragTouchMoveHandler),xe(s,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&xe(s,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=ce(i,a.delay)))},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;B(ue(t.clientX-this._lastX),ue(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){U&&Ce(U),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;ye(e,"mouseup",this._disableDelayedDrag),ye(e,"touchend",this._disableDelayedDrag),ye(e,"touchcancel",this._disableDelayedDrag),ye(e,"mousemove",this._delayedDragTouchMoveHandler),ye(e,"touchmove",this._delayedDragTouchMoveHandler),ye(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||("touch"==e.pointerType?e:null),!this.nativeDraggable||t?this.options.supportPointer?xe(se,"pointermove",this._onTouchMove):xe(se,t?"touchmove":"mousemove",this._onTouchMove):(xe(U,"dragend",this),xe(j,"dragstart",this._onDragStart));try{se.selection?Ye(function(){se.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(m=!1,j&&U){this.nativeDraggable&&(xe(se,"dragover",this._handleAutoScroll),xe(se,"dragover",V));var o=this.options;!e&&_e(U,o.dragClass,!1),_e(U,o.ghostClass,!0),Se(U,"transform",""),ve.active=this,e&&this._appendGhost(),Te(this,j,"start",U,j,j,G,void 0,t)}else this._nulling()},_emulateDragOver:function(e){if(N){if(this._lastX===N.clientX&&this._lastY===N.clientY&&!e)return;this._lastX=N.clientX,this._lastY=N.clientY,W();for(var t=se.elementFromPoint(N.clientX,N.clientY),o=t;t&&t.shadowRoot;)o=t=t.shadowRoot.elementFromPoint(N.clientX,N.clientY);if(o)do{if(o[ae])if(o[ae]._onDragOver({clientX:N.clientX,clientY:N.clientY,target:t,rootEl:o})&&!this.options.dragoverBubble)break;t=o}while(o=o.parentNode);U.parentNode[ae]._computeIsAligned(N),z()}},_onTouchMove:function(e,t){if(f){var o=this.options,n=o.fallbackTolerance,i=o.fallbackOffset,r=e.touches?e.touches[0]:e,l=h&&we(h),a=h&&l&&l.a,s=h&&l&&l.d,c=w&&g&&Ve(g),d=(r.clientX-f.clientX+i.x)/(a||1)+(c?c[0]-v[0]:0)/(a||1),p=(r.clientY-f.clientY+i.y)/(s||1)+(c?c[1]-v[1]:0)/(s||1),u=e.touches?"translate3d("+d+"px,"+p+"px,0)":"translate("+d+"px,"+p+"px)";if(!ve.active&&!m){if(n&&C(ue(r.clientX-this._lastX),ue(r.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}!t&&this._handleAutoScroll(r,!0),J=!0,N=r,Se(h,"webkitTransform",u),Se(h,"mozTransform",u),Se(h,"msTransform",u),Se(h,"transform",u),e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!h){var e=this.options.fallbackOnBody?se.body:j,t=Re(U,!0,e,!w),o=(Se(U),this.options);if(w){for(g=e;"static"===Se(g,"position")&&"none"===Se(g,"transform")&&g!==se;)g=g.parentNode;if(g!==se){var n=Re(g,!0);t.top-=n.top,t.left-=n.left}g!==se.body&&g!==se.documentElement?(g===se&&(g=Y()),t.top+=g.scrollTop,t.left+=g.scrollLeft):g=Y(),v=Ve(g)}_e(h=U.cloneNode(!0),o.ghostClass,!1),_e(h,o.fallbackClass,!0),_e(h,o.dragClass,!0),Se(h,"box-sizing","border-box"),Se(h,"margin",0),Se(h,"top",t.top),Se(h,"left",t.left),Se(h,"width",t.width),Se(h,"height",t.height),Se(h,"opacity","0.8"),Se(h,"position",w?"absolute":"fixed"),Se(h,"zIndex","100000"),Se(h,"pointerEvents","none"),e.appendChild(h)}},_onDragStart:function(e,t){var o=this,n=e.dataTransfer,i=o.options;(u=Xe(U)).draggable=!1,u.style["will-change"]="",this._hideClone(),_e(u,o.options.chosenClass,!1),o._cloneId=Ye(function(){o.options.removeCloneOnHide||j.insertBefore(u,U),Te(o,j,"clone",U)}),!t&&_e(U,i.dragClass,!0),t?(ie=!0,o._loopId=setInterval(o._emulateDragOver,50)):(ye(se,"mouseup",o._onDrop),ye(se,"touchend",o._onDrop),ye(se,"touchcancel",o._onDrop),n&&(n.effectAllowed="move",i.setData&&i.setData.call(o,n,U)),xe(se,"drop",o),Se(U,"transform","translateZ(0)")),m=!0,o._dragStartId=Ye(o._dragStarted.bind(o,t,e)),xe(se,"selectstart",o),S&&Se(se.body,"user-select","none")},_onDragOver:function(t){var o,n,e,i=this.el,r=t.target,l=this.options,a=l.group,s=ve.active,c=Z===a,d=l.sort,p=this;if(!pe&&(!de||t.rootEl||t.artificialBubble||fe(i,r))){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),J=!0,r=be(r,l.draggable,i,!0),be(t.target,null,U,!0)||r.animated)return W(!1);if(r!==U&&(ie=!1),s&&!l.disabled&&(c?d||(e=!j.contains(U)):Q===this||(this.lastPutMode=Z.checkPull(this,s,U,t))&&a.checkPut(this,s,U,t))){var u=this._getDirection(t,r);if(o=Re(U),e)return this._hideClone(),q=j,K?j.insertBefore(U,K):j.appendChild(U),W(!0);var h=Me(i);if(h&&(P=t,H=u,X=Re(Me(i)),Y="vertical"===H?P.clientY:P.clientX,L="vertical"===H?P.clientX:P.clientY,R="vertical"===H?X.bottom:X.right,F="vertical"===H?X.left:X.top,V="vertical"===H?X.right:X.bottom,!("vertical"===H?V+10<L||L<=V&&R<Y&&F<=L:R<Y&&F<L||Y<=R&&V+10<L)||h.animated)){if(r&&r!==U&&r.parentNode===i){var f,g=0,m=r.sortableMouseAligned,v=U.parentNode!==i,b="vertical"===u?"top":"left",x=Fe(r,"top")||Fe(U,"top"),y=x?x.scrollTop:void 0;if($!==r&&(te=null,f=Re(r)[b],re=!1),T=r,E=u,C=(D=U)===U&&ne||Re(D),B=T===U&&ne||Re(T),k="vertical"===E?C.left:C.top,M="vertical"===E?C.right:C.bottom,I="vertical"===E?C.width:C.height,O="vertical"===E?B.left:B.top,A="vertical"===E?B.right:B.bottom,N="vertical"===E?B.width:B.height,te=(k===O||M===A||k+I/2===O+N/2)&&m||v||x||l.invertSwap||"insert"===te||"swap"===te?("swap"!==te&&(le=l.invertSwap||v),g=function(e,t,o,n,i,r,l){var a=Re(t),s="vertical"===o?e.clientY:e.clientX,c="vertical"===o?a.height:a.width,d="vertical"===o?a.top:a.left,p="vertical"===o?a.bottom:a.right,u=Re(U),h=!1;if(!r)if(l&&oe<c*n)if(!re&&(1===ee?d+c*i/2<s:s<p-c*i/2)&&(re=!0),re)h=!0;else{"vertical"===o?u.top:u.left,"vertical"===o?u.bottom:u.right;if(1===ee?s<d+oe:p-oe<s)return-1*ee}else if(d+c*(1-n)/2<s&&s<p-c*(1-n)/2)return Ie(t);if((h=h||r)&&(s<d+c*i/2||p-c*i/2<s))return d+c/2<s?1:-1;return 0}(t,r,u,l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,le,$===r),"swap"):(g=Ie(r),"insert"),0===g)return W(!1);ne=null,ee=g,n=Re($=r);var _=r.nextElementSibling,S=!1,w=Ee(j,i,U,o,r,n,t,S=1===g);if(!1!==w)return 1!==w&&-1!==w||(S=1===w),pe=!0,ce(Be,30),c?s._hideClone():s._showClone(this),S&&!_?i.appendChild(U):r.parentNode.insertBefore(U,S?_:r),x&&he(x,0,y-x.scrollTop),q=U.parentNode,void 0===f||le||(oe=ue(f-Re(r)[b])),z(),W(!0)}}else if(h&&i===t.target&&(r=h),r&&(n=Re(r)),c?s._hideClone():s._showClone(this),!1!==Ee(j,i,U,o,r,n,t,!!r))return i.appendChild(U),q=i,ne=null,z(),W(!0);if(i.contains(U))return W(!1)}var D,T,E,C,B,k,M,I,O,A,N,P,H,X,Y,L,R,F,V;return de&&!t.rootEl&&ge(i,t,"_onDragOver"),!1}function W(e){return e&&(c?s._hideClone():s._showClone(p),s&&(_e(U,Q?Q.options.ghostClass:s.options.ghostClass,!1),_e(U,l.ghostClass,!0)),Q!==p&&p!==ve.active?Q=p:p===ve.active&&(Q=null),o&&p._animate(o,U),r&&n&&p._animate(n,r)),(r===U&&!U.animated||r===i&&!r.animated)&&($=null),l.dragoverBubble||t.rootEl||r===se||(p._handleAutoScroll(t),U.parentNode[ae]._computeIsAligned(t)),!l.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),!0}function z(){Te(p,j,"change",r,i,j,G,Ae(U,l.draggable),t)}},_animate:function(e,t){var o=this.options.animation;if(o){var n=Re(t);if(t===U&&(ne=n),1===e.nodeType&&(e=Re(e)),e.left+e.width/2!==n.left+n.width/2||e.top+e.height/2!==n.top+n.height/2){var i=we(this.el),r=i&&i.a,l=i&&i.d;Se(t,"transition","none"),Se(t,"transform","translate3d("+(e.left-n.left)/(r||1)+"px,"+(e.top-n.top)/(l||1)+"px,0)"),t.offsetWidth,Se(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),Se(t,"transform","translate3d(0,0,0)")}"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=ce(function(){Se(t,"transition",""),Se(t,"transform",""),t.animated=!1},o)}},_offUpEvents:function(){var e=this.el.ownerDocument;ye(se,"touchmove",this._onTouchMove),ye(se,"pointermove",this._onTouchMove),ye(e,"mouseup",this._onDrop),ye(e,"touchend",this._onDrop),ye(e,"pointerup",this._onDrop),ye(e,"touchcancel",this._onDrop),ye(se,"selectstart",this)},_onDrop:function(e){var t=this.el,o=this.options;re=le=H=m=!1,clearInterval(this._loopId),clearInterval(a),R(),clearTimeout(me),me=void 0,clearTimeout(this._dragStartTimer),Le(this._cloneId),Le(this._dragStartId),ye(se,"mousemove",this._onTouchMove),this.nativeDraggable&&(ye(se,"drop",this),ye(t,"dragstart",this._onDragStart),ye(se,"dragover",this._handleAutoScroll),ye(se,"dragover",V)),S&&Se(se.body,"user-select",""),this._offUpEvents(),e&&(J&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),h&&h.parentNode&&h.parentNode.removeChild(h),(j===q||Q&&"clone"!==Q.lastPutMode)&&u&&u.parentNode&&u.parentNode.removeChild(u),U&&(this.nativeDraggable&&ye(U,"dragend",this),Ce(U),U.style["will-change"]="",_e(U,Q?Q.options.ghostClass:this.options.ghostClass,!1),_e(U,this.options.chosenClass,!1),Te(this,j,"unchoose",U,q,j,G,null,e),j!==q?(0<=(n=Ae(U,o.draggable))&&(Te(null,q,"add",U,q,j,G,n,e),Te(this,j,"remove",U,q,j,G,n,e),Te(null,q,"sort",U,q,j,G,n,e),Te(this,j,"sort",U,q,j,G,n,e)),Q&&Q.save()):U.nextSibling!==K&&0<=(n=Ae(U,o.draggable))&&(Te(this,j,"update",U,q,j,G,n,e),Te(this,j,"sort",U,q,j,G,n,e)),ve.active&&(null!=n&&-1!==n||(n=G),Te(this,j,"end",U,q,j,G,n,e),this.save()))),this._nulling()},_nulling:function(){j=U=q=h=K=u=p=I=O=P.length=a=s=c=f=N=J=n=G=$=ee=ne=Q=Z=ve.active=null,k.forEach(function(e){e.checked=!0}),k.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":U&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],o=this.el.children,n=0,i=o.length,r=this.options;n<i;n++)be(e=o[n],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||Oe(e));return t},sort:function(e){var n={},i=this.el;this.toArray().forEach(function(e,t){var o=i.children[t];be(o,this.options.draggable,i,!1)&&(n[e]=o)},this),e.forEach(function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return be(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var o=this.options;if(void 0===t)return o[e];o[e]=t,"group"===e&&F(o)},destroy:function(){var e=this.el;e[ae]=null,ye(e,"mousedown",this._onTapStart),ye(e,"touchstart",this._onTapStart),ye(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(ye(e,"dragover",this),ye(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),d.splice(d.indexOf(this.el),1),this.el=e=null},_hideClone:function(){u.cloneHidden||(Se(u,"display","none"),u.cloneHidden=!0,u.parentNode&&this.options.removeCloneOnHide&&u.parentNode.removeChild(u))},_showClone:function(e){"clone"===e.lastPutMode?u.cloneHidden&&(j.contains(U)&&!this.options.group.revertClone?j.insertBefore(u,U):K?j.insertBefore(u,K):j.appendChild(u),this.options.group.revertClone&&this._animate(U,u),Se(u,"display",""),u.cloneHidden=!1):this._hideClone()}},xe(se,"touchmove",function(e){(ve.active||m)&&e.cancelable&&e.preventDefault()}),ve.utils={on:xe,off:ye,css:Se,find:De,is:function(e,t){return!!be(e,t,e,!1)},extend:He,throttle:Pe,closest:be,toggleClass:_e,clone:Xe,index:Ae,nextTick:Ye,cancelNextTick:Le,detectDirection:M,getChild:ke},ve.create=function(e,t){return new ve(e,t)},ve.version="1.8.4",ve});var SuperBoxSelectTV=function(e){e=e||{},SuperBoxSelectTV.superclass.constructor.call(this,e)};Ext.extend(SuperBoxSelectTV,Ext.Component,{page:{},window:{},grid:{},tree:{},panel:{},combo:{},config:{},jquery:{},form:{}}),Ext.reg("superboxselecttv",SuperBoxSelectTV);var SuperBoxSelect=new SuperBoxSelectTV;SuperBoxSelect.panel.InputOptions=function(e){e=e||{},this.options=e.options,this.params=e.params,Ext.applyIf(e,{layout:"form",autoHeight:!0,cls:"form-with-labels",labelAlign:"top",border:!1,items:[{layout:"column",items:[{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"modx-combo",fieldLabel:_("superboxselect.selectType"),description:MODx.expandHelp?"":_("superboxselect.selectType_desc"),name:"inopt_selectType",hiddenName:"inopt_selectType",id:"inopt_selectType",value:this.params.selectType||"resources",anchor:"100%",url:SuperBoxSelect.config.connectorUrl,baseParams:{action:"mgr/selecttypes/getlist",tvId:MODx.request.id,package:this.params.selectPackage||""},listeners:{select:{fn:this.selectType,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_selectType",html:_("superboxselect.selectType_desc"),cls:"desc-under"}]},{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"textfield",fieldLabel:_("superboxselect.selectPackage"),description:MODx.expandHelp?"":_("superboxselect.selectPackage_desc"),name:"inopt_selectPackage",id:"inopt_selectPackage",value:this.params.selectPackage||"",anchor:"100%",hidden:!SuperBoxSelect.config.advanced,listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_selectPackage",html:_("superboxselect.selectPackage_desc"),cls:"desc-under",hidden:!SuperBoxSelect.config.advanced}]}]},{layout:"column",items:[{columnWidth:.33,layout:"form",labelAlign:"top",items:[{xtype:"textfield",fieldLabel:_("superboxselect.maxElements"),description:MODx.expandHelp?"":_("superboxselect.maxElements_desc"),name:"inopt_maxElements",id:"inopt_maxElements",value:this.params.maxElements||this.params.maxResources||"",anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_maxElements",html:_("superboxselect.maxElements_desc"),cls:"desc-under"}]},{columnWidth:.33,layout:"form",labelAlign:"top",items:[{xtype:"textfield",fieldLabel:_("superboxselect.fieldTpl"),description:MODx.expandHelp?"":_("superboxselect.fieldTpl_desc"),name:"inopt_fieldTpl",id:"inopt_fieldTpl",value:this.params.fieldTpl||"",anchor:"100%",hidden:!SuperBoxSelect.config.advanced,listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_fieldTpl",html:_("superboxselect.fieldTpl_desc"),cls:"desc-under",hidden:!SuperBoxSelect.config.advanced}]},{columnWidth:.34,layout:"form",labelAlign:"top",items:[{xtype:"combo-boolean",fieldLabel:_("superboxselect.stackItems"),description:MODx.expandHelp?"":_("superboxselect.stackItems_desc"),name:"inopt_stackItems",hiddenName:"inopt_stackItems",id:"inopt_stackItems",value:1===this.params.stackItems||"true"===this.params.stackItems?1:0,anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_stackItems",html:_("superboxselect.stackItems_desc"),cls:"desc-under"}]}]},{layout:"column",items:[{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"combo-boolean",fieldLabel:_("required"),description:MODx.expandHelp?"":_("required_desc"),name:"inopt_allowBlank",hiddenName:"inopt_allowBlank",id:"inopt_allowBlank",value:0===this.params.allowBlank||"false"===this.params.allowBlank?0:1,anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_allowBlank",html:_("required_desc"),cls:"desc-under"}]},{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"numberfield",fieldLabel:_("superboxselect.pageSize"),description:MODx.expandHelp?"":_("superboxselect.pageSize_desc"),name:"inopt_pageSize",id:"inopt_pageSize",value:this.params.pageSize||10,allowNegative:!1,allowDecimals:!1,anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_pageSize",html:_("superboxselect.pageSize_desc"),cls:"desc-under"}]}]},{xtype:"superboxselect-panel-inputoptions-types",params:this.params},{cls:"treehillstudio_about",html:'<img width="133" height="40" src="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio-small.png" srcset="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio-small@2x.png 2x" alt="Treehill Studio">',listeners:{afterrender:function(e){e.getEl().select("img").on("click",function(){var e='<span style="display: inline-block; text-align: center;">&copy; 2011-2016 by Benjamin Vauchel <a href="https://github.com/benjamin-vauchel" target="_blank">github.com/benjamin-vauchel</a><br><img src="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio.png" srcset="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio@2x.png 2x" alt"Treehill Studio" style="margin-top: 10px"><br>&copy; 2016-2019 by <a href="https://treehillstudio.com" target="_blank">treehillstudio.com</a></span>';Ext.Msg.show({title:_("superboxselect")+" "+SuperBoxSelect.config.version,msg:e,buttons:Ext.Msg.OK,cls:"treehillstudio_window",width:330})})}}}],listeners:{afterrender:{fn:this.inputOptionsAfterRender,scope:this}}}),SuperBoxSelect.panel.InputOptions.superclass.constructor.call(this,e)},Ext.extend(SuperBoxSelect.panel.InputOptions,MODx.Panel,{selectType:function(e,t){var o=Ext.getCmp("modx-input-props").getEl().select(".alltypes");o&&o.each(function(e){e.setStyle("height","0")});var n=Ext.getCmp("type_"+t.id);n&&n.getEl().setStyle("height",null)},inputOptionsAfterRender:function(){var e=Ext.getCmp("inopt_selectType").getValue();if(e){var t=Ext.getCmp("type_"+e);t&&t.getEl().setStyle("height",null)}var o=Ext.getCmp("modx-tv-elements");o&&o.itemCt.applyStyles({height:"0",overflow:"hidden"})},markDirty:function(){Ext.getCmp("modx-panel-tv").markDirty()}}),Ext.reg("superboxselect-panel-inputoptions",SuperBoxSelect.panel.InputOptions),SuperBoxSelect.combo.SuperBoxSelectTV=function(e){e=e||{},this.options=e.options,this.params=e.params,this.tvid=this.options.tvid,this.maxElements=this.options.maxElements,Ext.applyIf(e,{addNewDataOnBlur:!1,allowBlank:this.options.allowBlank,anchor:"100%",classField:"cls",ctCls:"superboxselect-tv",displayField:"title",displayFieldTpl:this.options.fieldTpl,fieldLabel:this.options.fieldLabel,listeners:{afterrender:{fn:this.afterrender,scope:this},beforeadditem:{fn:this.beforeadditem,scope:this},additem:{fn:this.additem,scope:this},removeitem:{fn:this.removeitem,scope:this}},minChars:2,mode:"remote",msgTarget:"title",name:"tv"+this.tvid+"[]",pageSize:this.options.pageSize,stackItems:this.options.stackItems,queryDelay:0,store:this.options.store,styleField:"style",tpl:'<tpl for="."><div class="x-combo-list-item">'+this.options.fieldTpl+"</div></tpl>",transform:"superboxselect-tv-"+this.tvid,triggerAction:"all",value:this.options.value,valueField:"id",width:400}),SuperBoxSelect.combo.SuperBoxSelectTV.superclass.constructor.call(this,e)},SuperBoxSelect.combo.SuperBoxSelectTV=Ext.extend(SuperBoxSelect.combo.SuperBoxSelectTV,Ext.ux.form.SuperBoxSelect,{afterrender:function(){if(this.maxElements){var e=Ext.get("tv"+this.tvid+"-caption"),t=_("superboxselect.maxElements_label").replace("{maxElements}",this.maxElements);e.dom.innerHTML=e.dom.innerHTML+' <span class="modx-tv-label-description">('+t+")</span>"}var n=this,o=document.querySelectorAll("#"+this.outerWrapEl.id+" ul")[0];o?(o.setAttribute("data-xcomponentid",this.id),new Sortable(o,{onEnd:function(e){if(e.currentTarget){var t=e.currentTarget.getAttribute("data-xcomponentid"),o=Ext.getCmp(t);o?(n.refreshSorting(o),MODx.fireResourceFormChange()):console.log("Unable to reference xComponentContext.")}}})):console.log("Unable to find select element")},beforeadditem:function(e){if(this.maxElements)return!(e.getCount()>this.maxElements-1)||(MODx.msg.alert(_("error"),_("superboxselect.maxElements_msg")),!1)},additem:function(){MODx.fireResourceFormChange()},removeitem:function(){MODx.fireResourceFormChange()},refreshSorting:function(e){var t,o=e.items.items,n=document.querySelectorAll("#"+e.outerWrapEl.dom.id+" .x-superboxselect-input"),i=function(e){return Array.prototype.slice.call(e.parentElement.children).indexOf(e)},s=function(e,t){for(var o=0;o<t.length;o+=1)if(t[o].value===e)return t[o]},r=function(e,t){var o=i(e.el.dom),n=i(t.el.dom);return o<n?-1:n<o?1:0};o.sort(r),t instanceof Function&&t(),function(e,t,o){var n=t[0].parentElement;if(!n)return console.debug("syncElementsByValue(), Unable to reference list root element.");for(var i=0;i<e.length;i+=1){var r=e[i],l=s(String(r.value),t),a=t[i];null!==l&&void 0!==a&&n.insertBefore(l,a)}o instanceof Function&&o()}(o,n[0].children),e.value=e.getValue()},getElementComponentContext:function(e){var t=Array.prototype.slice.call(e.classList);return"body"!==e.tagName?null:t.indexOf("x-superboxselect")?e:void getElementComponentContext(e.parentElement)}}),Ext.reg("superboxselect-combo-superboxselectv",SuperBoxSelect.combo.SuperBoxSelectTV),SuperBoxSelect.combo.SuperBoxSelectTVSingle=function(e){e=e||{},this.options=e.options,this.params=e.params,this.tvid=this.options.tvid,Ext.applyIf(e,{allowBlank:this.options.allowBlank,anchor:"100%",ctCls:"superboxselect-tv",displayField:"title",fieldLabel:this.options.fieldLabel,hiddenName:"tv"+this.tvid,minChars:2,mode:"remote",msgTarget:"title",name:"tv"+this.tvid,pageSize:this.options.pageSize,queryDelay:0,store:this.options.store,tpl:'<tpl for="."><div class="x-combo-list-item">'+this.options.fieldTpl+"</div></tpl>",transform:"superboxselect-tv-"+this.tvid,triggerAction:"all",value:this.options.value,valueField:"id",width:400}),SuperBoxSelect.combo.SuperBoxSelectTVSingle.superclass.constructor.call(this,e)},SuperBoxSelect.combo.SuperBoxSelectTVSingle=Ext.extend(SuperBoxSelect.combo.SuperBoxSelectTVSingle,Ext.form.ComboBox),Ext.reg("superboxselect-combo-superboxselectv-single",SuperBoxSelect.combo.SuperBoxSelectTVSingle),SuperBoxSelectTV.Renderer=function(e){return e.length,""};