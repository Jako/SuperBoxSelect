/*!
 * SuperBoxSelect - Advanced Listbox/Resource List Template Variable Type
 * Version: 2.3.3
 * Build date: 2019-05-06
 */

!function(e){"use strict";"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&void 0!==module.exports?module.exports=e():window.Sortable=e()}(function(){"use strict";if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};function I(e,t){if(!e||!e.getBoundingClientRect)return ue();var o=e,n=!1;do{if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var i=we(o);if(o.clientWidth<o.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||o.clientHeight<o.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!o||!o.getBoundingClientRect||o===J.body)return ue();if(n||t)return o;n=!0}}}while(o=o.parentNode);return ue()}function O(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function n(e){E&&E.parentNode&&E.parentNode[Q]&&E.parentNode[Q]._computeIsAligned(e)}function u(){!ie&&f&&we(f,"display","none")}function h(){!ie&&f&&we(f,"display","")}var E,C,f,g,B,k,m,A,N,P,M,i,H,r,X,Y,a,s,c,v,L,R,F,V,W,z,b,U,q=[],j=!1,x=!1,K=!1,d=[],G=!1,Z=!1,y=[],l=/\s+/g,Q="Sortable"+(new Date).getTime(),_=window,J=_.document,S=_.parseInt,$=_.setTimeout,t=_.jQuery||_.Zepto,o=_.Polymer,p={capture:!1,passive:!1},w=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),D=!!navigator.userAgent.match(/Edge/i),T=!!navigator.userAgent.match(/firefox/i),ee=!(!navigator.userAgent.match(/safari/i)||navigator.userAgent.match(/chrome/i)||navigator.userAgent.match(/android/i)),te=!!navigator.userAgent.match(/iP(ad|od|hone)/i),oe=D||w?"cssFloat":"float",ne="draggable"in J.createElement("div"),ie=function(){if(w)return!1;var e=J.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}(),re=!1,le=!1,ae=Math.abs,se=Math.min,ce=Math.max,de=[],pe=function(e,t){var o=we(e),n=S(o.width)-S(o.paddingLeft)-S(o.paddingRight)-S(o.borderLeftWidth)-S(o.borderRightWidth),i=Me(e,0,t),r=Me(e,1,t),l=i&&we(i),a=r&&we(r),s=l&&S(l.marginLeft)+S(l.marginRight)+Re(i).width,c=a&&S(a.marginLeft)+S(a.marginRight)+Re(r).width;if("flex"===o.display)return"column"===o.flexDirection||"column-reverse"===o.flexDirection?"vertical":"horizontal";if("grid"===o.display)return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&"none"!==l.float){var d="left"===l.float?"left":"right";return!r||"both"!==a.clear&&a.clear!==d?"horizontal":"vertical"}return i&&("block"===l.display||"flex"===l.display||"table"===l.display||"grid"===l.display||n<=s&&"none"===o[oe]||r&&"none"===o[oe]&&n<s+c)?"vertical":"horizontal"},ue=function(){return w?J.documentElement:J.scrollingElement},he=e(function(o,e,t,n){if(e.scroll){var i=t?t[Q]:window,r=e.scrollSensitivity,l=e.scrollSpeed,a=o.clientX,s=o.clientY,c=ue(),d=!1;N!==t&&(fe(),A=e.scroll,P=e.scrollFn,!0===A&&(A=I(t,!0),N=A));var p=0,u=A;do{var h,f,g,m,v,b,x,y,_,S=u,w=Re(S),D=w.top,T=w.bottom,E=w.left,C=w.right,B=w.width,k=w.height;if(h=S.scrollWidth,f=S.scrollHeight,g=we(S),y=S.scrollLeft,_=S.scrollTop,x=S===c?(b=B<h&&("auto"===g.overflowX||"scroll"===g.overflowX||"visible"===g.overflowX),k<f&&("auto"===g.overflowY||"scroll"===g.overflowY||"visible"===g.overflowY)):(b=B<h&&("auto"===g.overflowX||"scroll"===g.overflowX),k<f&&("auto"===g.overflowY||"scroll"===g.overflowY)),m=b&&(ae(C-a)<=r&&y+B<h)-(ae(E-a)<=r&&!!y),v=x&&(ae(T-s)<=r&&_+k<f)-(ae(D-s)<=r&&!!_),!q[p])for(var M=0;M<=p;M++)q[M]||(q[M]={});q[p].vx==m&&q[p].vy==v&&q[p].el===S||(q[p].el=S,q[p].vx=m,q[p].vy=v,clearInterval(q[p].pid),!S||0==m&&0==v||(d=!0,q[p].pid=setInterval(function(){n&&0===this.layer&&(be.active._emulateDragOver(!0),be.active._onTouchMove(L,!0));var e=q[this.layer].vy?q[this.layer].vy*l:0,t=q[this.layer].vx?q[this.layer].vx*l:0;"function"==typeof P&&"continue"!==P.call(i,t,e,o,L,q[this.layer].el)||O(q[this.layer].el,t,e)}.bind({layer:p}),24))),p++}while(e.bubbleScroll&&u!==c&&(u=I(u,!1)));j=d}},30),fe=function(){q.forEach(function(e){clearInterval(e.pid)}),q=[]},ge=function(e){function s(l,a){return function(e,t,o,n){var i=e.options.group.name&&t.options.group.name&&e.options.group.name===t.options.group.name;if(null==l&&(a||i))return!0;if(null==l||!1===l)return!1;if(a&&"clone"===l)return l;if("function"==typeof l)return s(l(e,t,o,n),a)(e,t,o,n);var r=(a?e:t).options.group.name;return!0===l||"string"==typeof l&&l===r||l.join&&-1<l.indexOf(r)}}var t={},o=e.group;o&&"object"==typeof o||(o={name:o}),t.name=o.name,t.checkPull=s(o.pull,!0),t.checkPut=s(o.put),t.revertClone=o.revertClone,e.group=t};J.addEventListener("click",function(e){if(K)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),K=!1},!0);function me(e){if(E){var t=function(e,t){for(var o=0;o<d.length;o++)if(!Ie(d[o])){var n=Re(d[o]),i=d[o][Q].options.emptyInsertThreshold,r=e>=n.left-i&&e<=n.right+i,l=t>=n.top-i&&t<=n.bottom+i;if(i&&r&&l)return d[o]}}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var o={};for(var n in e)o[n]=e[n];o.target=o.rootEl=t,o.preventDefault=void 0,o.stopPropagation=void 0,t[Q]._onDragOver(o)}}}var ve;function be(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(e);this.el=e,this.options=t=He({},t),e[Q]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return pe(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:S(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==be.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var n in o)n in t||(t[n]=o[n]);for(var i in ge(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&ne,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?ye(e,"pointerdown",this._onTapStart):(ye(e,"mousedown",this._onTapStart),ye(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(ye(e,"dragover",this),ye(e,"dragenter",this)),d.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[])}function xe(e,t,o,n){if(e){o=o||J;do{if(null!=t&&(">"===t[0]?e.parentNode===o&&Pe(e,t):Pe(e,t))||n&&e===o)return e;if(e===o)break}while(e=(i=e).host&&i!==J&&i.host.nodeType?i.host:i.parentNode)}var i;return null}function ye(e,t,o){e.addEventListener(t,o,!w&&p)}function _e(e,t,o){e.removeEventListener(t,o,!w&&p)}function Se(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(l," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(l," ")}}function we(e,t,o){var n=e&&e.style;if(n){if(void 0===o)return J.defaultView&&J.defaultView.getComputedStyle?o=J.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),void 0===t?o:o[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=o+("string"==typeof o?"":"px")}}function De(e){var t="";do{var o=we(e,"transform");o&&"none"!==o&&(t=o+" "+t)}while(e=e.parentNode);return window.DOMMatrix?new DOMMatrix(t):window.WebKitCSSMatrix?new WebKitCSSMatrix(t):window.CSSMatrix?new CSSMatrix(t):void 0}function Te(e,t,o){if(e){var n=e.getElementsByTagName(t),i=0,r=n.length;if(o)for(;i<r;i++)o(n[i],i);return n}return[]}function Ee(e,t,o,n,i,r,l,a,s,c,d){var p,u=(e=e||t[Q]).options,h="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||w||D?(p=J.createEvent("Event")).initEvent(o,!0,!0):p=new CustomEvent(o,{bubbles:!0,cancelable:!0}),p.to=i||t,p.from=r||t,p.item=n||t,p.clone=g,p.oldIndex=l,p.newIndex=a,p.oldDraggableIndex=s,p.newDraggableIndex=c,p.originalEvent=d,p.pullMode=Y?Y.lastPutMode:void 0,t&&t.dispatchEvent(p),u[h]&&u[h].call(e,p)}function Ce(e,t,o,n,i,r,l,a){var s,c,d=e[Q],p=d.options.onMove;return!window.CustomEvent||w||D?(s=J.createEvent("Event")).initEvent("move",!0,!0):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=t,s.from=e,s.dragged=o,s.draggedRect=n,s.related=i||t,s.relatedRect=r||Re(t),s.willInsertAfter=a,s.originalEvent=l,e.dispatchEvent(s),p&&(c=p.call(d,s,l)),c}function Be(e){e.draggable=!1}function ke(){re=!1}function Me(e,t,o){for(var n=0,i=0,r=e.children;i<r.length;){if("none"!==r[i].style.display&&r[i]!==f&&r[i]!==E&&xe(r[i],o.draggable,e,!1)){if(n===t)return r[i];n++}i++}return null}function Ie(e){for(var t=e.lastElementChild;t&&(t===f||"none"===we(t,"display"));)t=t.previousElementSibling;return t||null}function Oe(e){return Ne(E)<Ne(e)?1:-1}function Ae(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Ne(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e&&(e=e.previousElementSibling);)"TEMPLATE"===e.nodeName.toUpperCase()||e===g||t&&!Pe(e,t)||o++;return o}function Pe(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function e(o,n){return function(){if(!ve){var e=arguments,t=this;ve=$(function(){1===e.length?o.call(t,e[0]):o.apply(t,e),ve=void 0},n)}}}function He(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function Xe(e){return o&&o.dom?o.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}function Ye(e){return $(e,0)}function Le(e){return clearTimeout(e)}function Re(e,t,o,n){if(e.getBoundingClientRect||e===_){var i,r,l,a,s,c,d;if(d=e!==_&&e!==ue()?(r=(i=e.getBoundingClientRect()).top,l=i.left,a=i.bottom,s=i.right,c=i.height,i.width):(l=r=0,a=window.innerHeight,s=window.innerWidth,c=window.innerHeight,window.innerWidth),n&&e!==_&&(o=o||e.parentNode,!w))do{if(o&&o.getBoundingClientRect&&"none"!==we(o,"transform")){var p=o.getBoundingClientRect();r-=p.top+S(we(o,"border-top-width")),l-=p.left+S(we(o,"border-left-width")),a=r+i.height,s=l+i.width;break}}while(o=o.parentNode);if(t&&e!==_){var u=De(o||e),h=u&&u.a,f=u&&u.d;u&&(a=(r/=f)+(c/=f),s=(l/=h)+(d/=h))}return{top:r,left:l,bottom:a,right:s,width:d,height:c}}}function Fe(e,t){for(var o=I(e,!0),n=Re(e)[t];o;){var i=Re(o)[t];if(!("top"===t||"left"===t?i<=n:n<=i))return o;if(o===ue())break;o=I(o,!1)}return!1}function Ve(e){var t=0,o=0,n=ue();if(e)do{var i=De(e),r=i.a,l=i.d;t+=e.scrollLeft*r,o+=e.scrollTop*l}while(e!==n&&(e=e.parentNode));return[t,o]}return be.prototype={constructor:be,_computeIsAligned:function(e){var t;if(f&&!ie?(u(),t=J.elementFromPoint(e.clientX,e.clientY),h()):t=e.target,t=xe(t,this.options.draggable,this.el,!1),!le&&E&&E.parentNode===this.el){for(var o,n,i,r,l,a,s,c,d=this.el.children,p=0;p<d.length;p++)xe(d[p],this.options.draggable,this.el,!1)&&d[p]!==t&&(d[p].sortableMouseAligned=(o=e.clientX,n=e.clientY,i=d[p],r=this._getDirection(e,null),this.options,void 0,l=Re(i),a="vertical"===r?l.left:l.top,s="vertical"===r?l.right:l.bottom,a<(c="vertical"===r?o:n)&&c<s));xe(t,this.options.draggable,this.el,!0)||(F=null),le=!0,$(function(){le=!1},30)}},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,E):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t,o,n=this,i=this.el,r=this.options,l=r.preventOnFilter,a=e.type,s=e.touches&&e.touches[0],c=(s||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||c,p=r.filter;if(function(e){de.length=0;var t=e.getElementsByTagName("input"),o=t.length;for(;o--;){var n=t[o];n.checked&&de.push(n)}}(i),!E&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||r.disabled||d.isContentEditable||(c=xe(c,r.draggable,i,!1),m===c))){if(t=Ne(c),o=Ne(c,r.draggable),"function"==typeof p){if(p.call(this,e,c,this))return Ee(n,d,"filter",c,i,i,t,void 0,o),void(l&&e.cancelable&&e.preventDefault())}else if(p&&(p=p.split(",").some(function(e){if(e=xe(d,e.trim(),i,!1))return Ee(n,e,"filter",c,i,i,t,void 0,o),!0})))return void(l&&e.cancelable&&e.preventDefault());r.handle&&!xe(d,r.handle,i,!1)||this._prepareDragStart(e,s,c,t,o)}}},_handleAutoScroll:function(t,o){if(E&&this.options.scroll){var n=t.clientX,i=t.clientY,e=J.elementFromPoint(n,i),r=this;if(o||D||w||ee){he(t,r.options,e,o);var l=I(e,!0);!j||a&&n===s&&i===c||(a&&clearInterval(a),a=setInterval(function(){if(E){var e=I(J.elementFromPoint(n,i),!0);e!==l&&(l=e,fe(),he(t,r.options,l,o))}},10),s=n,c=i)}else{if(!r.options.bubbleScroll||I(e,!0)===ue())return void fe();he(t,r.options,I(e,!1),!1)}}},_prepareDragStart:function(e,t,o,n,i){var r,l=this,a=l.el,s=l.options,c=a.ownerDocument;o&&!E&&o.parentNode===a&&(B=a,C=(E=o).parentNode,k=E.nextSibling,m=o,X=s.group,M=n,H=i,v={target:E,clientX:(t||e).clientX,clientY:(t||e).clientY},this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,E.style["will-change"]="all",E.style.transition="",E.style.transform="",r=function(){l._disableDelayedDragEvents(),!T&&l.nativeDraggable&&(E.draggable=!0),l._triggerDragStart(e,t),Ee(l,B,"choose",E,B,B,M,void 0,H),Se(E,s.chosenClass,!0)},s.ignore.split(",").forEach(function(e){Te(E,e.trim(),Be)}),ye(c,"dragover",me),ye(c,"mousemove",me),ye(c,"touchmove",me),ye(c,"mouseup",l._onDrop),ye(c,"touchend",l._onDrop),ye(c,"touchcancel",l._onDrop),T&&this.nativeDraggable&&(this.options.touchStartThreshold=4,E.draggable=!0),!s.delay||s.delayOnTouchOnly&&!t||this.nativeDraggable&&(D||w)?r():(ye(c,"mouseup",l._disableDelayedDrag),ye(c,"touchend",l._disableDelayedDrag),ye(c,"touchcancel",l._disableDelayedDrag),ye(c,"mousemove",l._delayedDragTouchMoveHandler),ye(c,"touchmove",l._delayedDragTouchMoveHandler),s.supportPointer&&ye(c,"pointermove",l._delayedDragTouchMoveHandler),l._dragStartTimer=$(r,s.delay)))},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;ce(ae(t.clientX-this._lastX),ae(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){E&&Be(E),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_e(e,"mouseup",this._disableDelayedDrag),_e(e,"touchend",this._disableDelayedDrag),_e(e,"touchcancel",this._disableDelayedDrag),_e(e,"mousemove",this._delayedDragTouchMoveHandler),_e(e,"touchmove",this._delayedDragTouchMoveHandler),_e(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||("touch"==e.pointerType?e:null),!this.nativeDraggable||t?this.options.supportPointer?ye(J,"pointermove",this._onTouchMove):ye(J,t?"touchmove":"mousemove",this._onTouchMove):(ye(E,"dragend",this),ye(B,"dragstart",this._onDragStart));try{J.selection?Ye(function(){J.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(x=!1,B&&E){this.nativeDraggable&&(ye(J,"dragover",this._handleAutoScroll),ye(J,"dragover",n));var o=this.options;e||Se(E,o.dragClass,!1),Se(E,o.ghostClass,!0),we(E,"transform",""),be.active=this,e&&this._appendGhost(),Ee(this,B,"start",E,B,B,M,void 0,H,void 0,t)}else this._nulling()},_emulateDragOver:function(e){if(L){if(this._lastX===L.clientX&&this._lastY===L.clientY&&!e)return;this._lastX=L.clientX,this._lastY=L.clientY,u();for(var t=J.elementFromPoint(L.clientX,L.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(L.clientX,L.clientY))!==o;)o=t;if(o)do{if(o[Q])if(o[Q]._onDragOver({clientX:L.clientX,clientY:L.clientY,target:t,rootEl:o})&&!this.options.dragoverBubble)break;t=o}while(o=o.parentNode);E.parentNode[Q]._computeIsAligned(L),h()}},_onTouchMove:function(e,t){if(v){var o=this.options,n=o.fallbackTolerance,i=o.fallbackOffset,r=e.touches?e.touches[0]:e,l=f&&De(f),a=f&&l&&l.a,s=f&&l&&l.d,c=te&&b&&Ve(b),d=(r.clientX-v.clientX+i.x)/(a||1)+(c?c[0]-y[0]:0)/(a||1),p=(r.clientY-v.clientY+i.y)/(s||1)+(c?c[1]-y[1]:0)/(s||1),u=e.touches?"translate3d("+d+"px,"+p+"px,0)":"translate("+d+"px,"+p+"px)";if(!be.active&&!x){if(n&&se(ae(r.clientX-this._lastX),ae(r.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}t||this._handleAutoScroll(r,!0),R=!0,L=r,we(f,"webkitTransform",u),we(f,"mozTransform",u),we(f,"msTransform",u),we(f,"transform",u),e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!f){var e=this.options.fallbackOnBody?J.body:B,t=Re(E,!0,e,!te),o=(we(E),this.options);if(te){for(b=e;"static"===we(b,"position")&&"none"===we(b,"transform")&&b!==J;)b=b.parentNode;if(b!==J){var n=Re(b,!0);t.top-=n.top,t.left-=n.left}b!==J.body&&b!==J.documentElement?(b===J&&(b=ue()),t.top+=b.scrollTop,t.left+=b.scrollLeft):b=ue(),y=Ve(b)}Se(f=E.cloneNode(!0),o.ghostClass,!1),Se(f,o.fallbackClass,!0),Se(f,o.dragClass,!0),we(f,"box-sizing","border-box"),we(f,"margin",0),we(f,"top",t.top),we(f,"left",t.left),we(f,"width",t.width),we(f,"height",t.height),we(f,"opacity","0.8"),we(f,"position",te?"absolute":"fixed"),we(f,"zIndex","100000"),we(f,"pointerEvents","none"),e.appendChild(f)}},_onDragStart:function(e,t){var o=this,n=e.dataTransfer,i=o.options;(g=Xe(E)).draggable=!1,g.style["will-change"]="",this._hideClone(),Se(g,o.options.chosenClass,!1),o._cloneId=Ye(function(){o.options.removeCloneOnHide||B.insertBefore(g,E),Ee(o,B,"clone",E)}),t||Se(E,i.dragClass,!0),t?(K=!0,o._loopId=setInterval(o._emulateDragOver,50)):(_e(J,"mouseup",o._onDrop),_e(J,"touchend",o._onDrop),_e(J,"touchcancel",o._onDrop),n&&(n.effectAllowed="move",i.setData&&i.setData.call(o,n,E)),ye(J,"drop",o),we(E,"transform","translateZ(0)")),x=!0,o._dragStartId=Ye(o._dragStarted.bind(o,t,e)),ye(J,"selectstart",o),ee&&we(J.body,"user-select","none")},_onDragOver:function(t){var o,n,e,i=this.el,r=t.target,l=this.options,a=l.group,s=be.active,c=X===a,d=l.sort,p=this;if(!re){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),R=!0,r=xe(r,l.draggable,i,!0),E.contains(t.target)||r.animated)return D(!1);if(r!==E&&(K=!1),s&&!l.disabled&&(c?d||(e=!B.contains(E)):Y===this||(this.lastPutMode=X.checkPull(this,s,E,t))&&a.checkPut(this,s,E,t))){var u=this._getDirection(t,r);if(o=Re(E),e)return this._hideClone(),C=B,k?B.insertBefore(E,k):B.appendChild(E),D(!0);var h=Ie(i);if(!h||function(e,t,o){var n=Re(Ie(o)),i="vertical"===t?e.clientY:e.clientX,r="vertical"===t?e.clientX:e.clientY,l="vertical"===t?n.bottom:n.right,a="vertical"===t?n.left:n.top,s="vertical"===t?n.right:n.bottom;return"vertical"===t?s+10<r||r<=s&&l<i&&a<=r:l<i&&a<r||i<=l&&s+10<r}(t,u,i)&&!h.animated){if(h&&i===t.target&&(r=h),r&&(n=Re(r)),c?s._hideClone():s._showClone(this),!1!==Ce(B,i,E,o,r,n,t,!!r))return i.appendChild(E),C=i,U=null,T(),D(!0)}else if(r&&r!==E&&r.parentNode===i){var f,g=0,m=r.sortableMouseAligned,v=E.parentNode!==i,b="vertical"===u?"top":"left",x=Fe(r,"top")||Fe(E,"top"),y=x?x.scrollTop:void 0;if(F!==r&&(W=null,f=Re(r)[b],G=!1),W=function(e,t,o){var n=e===E&&U||Re(e),i=t===E&&U||Re(t),r="vertical"===o?n.left:n.top,l="vertical"===o?n.right:n.bottom,a="vertical"===o?n.width:n.height,s="vertical"===o?i.left:i.top,c="vertical"===o?i.right:i.bottom,d="vertical"===o?i.width:i.height;return r===s||l===c||r+a/2===s+d/2}(E,r,u)&&m||v||x||l.invertSwap||"insert"===W||"swap"===W?("swap"!==W&&(Z=l.invertSwap||v),g=function(e,t,o,n,i,r,l){var a=Re(t),s="vertical"===o?e.clientY:e.clientX,c="vertical"===o?a.height:a.width,d="vertical"===o?a.top:a.left,p="vertical"===o?a.bottom:a.right,u=Re(E),h=!1;if(!r)if(l&&z<c*n)if(!G&&(1===V?d+c*i/2<s:s<p-c*i/2)&&(G=!0),G)h=!0;else{"vertical"===o?u.top:u.left,"vertical"===o?u.bottom:u.right;if(1===V?s<d+z:p-z<s)return-1*V}else if(d+c*(1-n)/2<s&&s<p-c*(1-n)/2)return Oe(t);if((h=h||r)&&(s<d+c*i/2||p-c*i/2<s))return d+c/2<s?1:-1;return 0}(t,r,u,l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Z,F===r),"swap"):(g=Oe(r),"insert"),0===g)return D(!1);U=null,V=g,n=Re(F=r);var _=r.nextElementSibling,S=!1,w=Ce(B,i,E,o,r,n,t,S=1===g);if(!1!==w)return 1!==w&&-1!==w||(S=1===w),re=!0,$(ke,30),c?s._hideClone():s._showClone(this),S&&!_?i.appendChild(E):r.parentNode.insertBefore(E,S?_:r),x&&O(x,0,y-x.scrollTop),C=E.parentNode,void 0===f||Z||(z=ae(f-Re(r)[b])),T(),D(!0)}if(i.contains(E))return D(!1)}return!1}function D(e){return e&&(c?s._hideClone():s._showClone(p),s&&(Se(E,Y?Y.options.ghostClass:s.options.ghostClass,!1),Se(E,l.ghostClass,!0)),Y!==p&&p!==be.active?Y=p:p===be.active&&(Y=null),o&&p._animate(o,E),r&&n&&p._animate(n,r)),(r===E&&!E.animated||r===i&&!r.animated)&&(F=null),l.dragoverBubble||t.rootEl||r===J||(p._handleAutoScroll(t),E.parentNode[Q]._computeIsAligned(t),e||me(t)),!l.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),!0}function T(){Ee(p,B,"change",r,i,B,M,Ne(E),H,Ne(E,l.draggable),t)}},_animate:function(e,t){var o=this.options.animation;if(o){var n=Re(t);if(t===E&&(U=n),1===e.nodeType&&(e=Re(e)),e.left+e.width/2!==n.left+n.width/2||e.top+e.height/2!==n.top+n.height/2){var i=De(this.el),r=i&&i.a,l=i&&i.d;we(t,"transition","none"),we(t,"transform","translate3d("+(e.left-n.left)/(r||1)+"px,"+(e.top-n.top)/(l||1)+"px,0)"),this._repaint(t),we(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),we(t,"transform","translate3d(0,0,0)")}"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=$(function(){we(t,"transition",""),we(t,"transform",""),t.animated=!1},o)}},_repaint:function(e){return e.offsetWidth},_offMoveEvents:function(){_e(J,"touchmove",this._onTouchMove),_e(J,"pointermove",this._onTouchMove),_e(J,"dragover",me),_e(J,"mousemove",me),_e(J,"touchmove",me)},_offUpEvents:function(){var e=this.el.ownerDocument;_e(e,"mouseup",this._onDrop),_e(e,"touchend",this._onDrop),_e(e,"pointerup",this._onDrop),_e(e,"touchcancel",this._onDrop),_e(J,"selectstart",this)},_onDrop:function(e){var t=this.el,o=this.options;G=Z=j=x=!1,clearInterval(this._loopId),clearInterval(a),fe(),clearTimeout(ve),ve=void 0,clearTimeout(this._dragStartTimer),Le(this._cloneId),Le(this._dragStartId),_e(J,"mousemove",this._onTouchMove),this.nativeDraggable&&(_e(J,"drop",this),_e(t,"dragstart",this._onDragStart),_e(J,"dragover",this._handleAutoScroll),_e(J,"dragover",n)),ee&&we(J.body,"user-select",""),this._offMoveEvents(),this._offUpEvents(),e&&(R&&(e.cancelable&&e.preventDefault(),o.dropBubble||e.stopPropagation()),f&&f.parentNode&&f.parentNode.removeChild(f),(B===C||Y&&"clone"!==Y.lastPutMode)&&g&&g.parentNode&&g.parentNode.removeChild(g),E&&(this.nativeDraggable&&_e(E,"dragend",this),Be(E),E.style["will-change"]="",Se(E,Y?Y.options.ghostClass:this.options.ghostClass,!1),Se(E,this.options.chosenClass,!1),Ee(this,B,"unchoose",E,C,B,M,null,H,null,e),B!==C?(i=Ne(E),r=Ne(E,o.draggable),0<=i&&(Ee(null,C,"add",E,C,B,M,i,H,r,e),Ee(this,B,"remove",E,C,B,M,i,H,r,e),Ee(null,C,"sort",E,C,B,M,i,H,r,e),Ee(this,B,"sort",E,C,B,M,i,H,r,e)),Y&&Y.save()):E.nextSibling!==k&&(i=Ne(E),r=Ne(E,o.draggable),0<=i&&(Ee(this,B,"update",E,C,B,M,i,H,r,e),Ee(this,B,"sort",E,C,B,M,i,H,r,e))),be.active&&(null!=i&&-1!==i||(i=M,r=H),Ee(this,B,"end",E,C,B,M,i,H,r,e),this.save()))),this._nulling()},_nulling:function(){B=E=C=f=k=g=m=A=N=q.length=a=s=c=v=L=R=i=M=F=V=U=Y=X=be.active=null,de.forEach(function(e){e.checked=!0}),de.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":E&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],o=this.el.children,n=0,i=o.length,r=this.options;n<i;n++)xe(e=o[n],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||Ae(e));return t},sort:function(e){var n={},i=this.el;this.toArray().forEach(function(e,t){var o=i.children[t];xe(o,this.options.draggable,i,!1)&&(n[e]=o)},this),e.forEach(function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return xe(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var o=this.options;if(void 0===t)return o[e];o[e]=t,"group"===e&&ge(o)},destroy:function(){var e=this.el;e[Q]=null,_e(e,"mousedown",this._onTapStart),_e(e,"touchstart",this._onTapStart),_e(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_e(e,"dragover",this),_e(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),d.splice(d.indexOf(this.el),1),this.el=e=null},_hideClone:function(){g.cloneHidden||(we(g,"display","none"),g.cloneHidden=!0,g.parentNode&&this.options.removeCloneOnHide&&g.parentNode.removeChild(g))},_showClone:function(e){"clone"===e.lastPutMode?g.cloneHidden&&(B.contains(E)&&!this.options.group.revertClone?B.insertBefore(g,E):k?B.insertBefore(g,k):B.appendChild(g),this.options.group.revertClone&&this._animate(E,g),we(g,"display",""),g.cloneHidden=!1):this._hideClone()}},ye(J,"touchmove",function(e){(be.active||x)&&e.cancelable&&e.preventDefault()}),be.utils={on:ye,off:_e,css:we,find:Te,is:function(e,t){return!!xe(e,t,e,!1)},extend:He,throttle:e,closest:xe,toggleClass:Se,clone:Xe,index:Ne,nextTick:Ye,cancelNextTick:Le,detectDirection:pe,getChild:Me},be.create=function(e,t){return new be(e,t)},be.version="1.9.0",be});var SuperBoxSelectTV=function(e){e=e||{},SuperBoxSelectTV.superclass.constructor.call(this,e)};Ext.extend(SuperBoxSelectTV,Ext.Component,{page:{},window:{},grid:{},tree:{},panel:{},combo:{},config:{},jquery:{},form:{}}),Ext.reg("superboxselecttv",SuperBoxSelectTV);var SuperBoxSelect=new SuperBoxSelectTV;SuperBoxSelect.panel.InputOptions=function(e){e=e||{},this.options=e.options,this.params=e.params,Ext.applyIf(e,{layout:"form",autoHeight:!0,cls:"form-with-labels",labelAlign:"top",border:!1,items:[{layout:"column",items:[{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"modx-combo",fieldLabel:_("superboxselect.selectType"),description:MODx.expandHelp?"":_("superboxselect.selectType_desc"),name:"inopt_selectType",hiddenName:"inopt_selectType",id:"inopt_selectType",value:this.params.selectType||"resources",anchor:"100%",url:SuperBoxSelect.config.connectorUrl,baseParams:{action:"mgr/selecttypes/getlist",tvId:MODx.request.id,package:this.params.selectPackage||""},listeners:{select:{fn:this.selectType,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_selectType",html:_("superboxselect.selectType_desc"),cls:"desc-under"}]},{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"textfield",fieldLabel:_("superboxselect.selectPackage"),description:MODx.expandHelp?"":_("superboxselect.selectPackage_desc"),name:"inopt_selectPackage",id:"inopt_selectPackage",value:this.params.selectPackage||"",anchor:"100%",hidden:!SuperBoxSelect.config.advanced,listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_selectPackage",html:_("superboxselect.selectPackage_desc"),cls:"desc-under",hidden:!SuperBoxSelect.config.advanced}]}]},{layout:"column",items:[{columnWidth:.33,layout:"form",labelAlign:"top",items:[{xtype:"textfield",fieldLabel:_("superboxselect.maxElements"),description:MODx.expandHelp?"":_("superboxselect.maxElements_desc"),name:"inopt_maxElements",id:"inopt_maxElements",value:this.params.maxElements||this.params.maxResources||"",anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_maxElements",html:_("superboxselect.maxElements_desc"),cls:"desc-under"}]},{columnWidth:.33,layout:"form",labelAlign:"top",items:[{xtype:"textfield",fieldLabel:_("superboxselect.fieldTpl"),description:MODx.expandHelp?"":_("superboxselect.fieldTpl_desc"),name:"inopt_fieldTpl",id:"inopt_fieldTpl",value:this.params.fieldTpl||"",anchor:"100%",hidden:!SuperBoxSelect.config.advanced,listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_fieldTpl",html:_("superboxselect.fieldTpl_desc"),cls:"desc-under",hidden:!SuperBoxSelect.config.advanced}]},{columnWidth:.34,layout:"form",labelAlign:"top",items:[{xtype:"combo-boolean",fieldLabel:_("superboxselect.stackItems"),description:MODx.expandHelp?"":_("superboxselect.stackItems_desc"),name:"inopt_stackItems",hiddenName:"inopt_stackItems",id:"inopt_stackItems",value:1===this.params.stackItems||"true"===this.params.stackItems?1:0,anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_stackItems",html:_("superboxselect.stackItems_desc"),cls:"desc-under"}]}]},{layout:"column",items:[{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"combo-boolean",fieldLabel:_("required"),description:MODx.expandHelp?"":_("required_desc"),name:"inopt_allowBlank",hiddenName:"inopt_allowBlank",id:"inopt_allowBlank",value:0===this.params.allowBlank||"false"===this.params.allowBlank?0:1,anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_allowBlank",html:_("required_desc"),cls:"desc-under"}]},{columnWidth:.5,layout:"form",labelAlign:"top",items:[{xtype:"numberfield",fieldLabel:_("superboxselect.pageSize"),description:MODx.expandHelp?"":_("superboxselect.pageSize_desc"),name:"inopt_pageSize",id:"inopt_pageSize",value:this.params.pageSize||10,allowNegative:!1,allowDecimals:!1,anchor:"100%",listeners:{change:{fn:this.markDirty,scope:this}}},{xtype:MODx.expandHelp?"label":"hidden",forId:"inopt_pageSize",html:_("superboxselect.pageSize_desc"),cls:"desc-under"}]}]},{xtype:"superboxselect-panel-inputoptions-types",params:this.params},{cls:"treehillstudio_about",html:'<img width="133" height="40" src="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio-small.png" srcset="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio-small@2x.png 2x" alt="Treehill Studio">',listeners:{afterrender:function(e){e.getEl().select("img").on("click",function(){var e='<span style="display: inline-block; text-align: center;">&copy; 2011-2016 by Benjamin Vauchel <a href="https://github.com/benjamin-vauchel" target="_blank">github.com/benjamin-vauchel</a><br><img src="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio.png" srcset="'+SuperBoxSelect.config.assetsUrl+'img/treehill-studio@2x.png 2x" alt"Treehill Studio" style="margin-top: 10px"><br>&copy; 2016-2019 by <a href="https://treehillstudio.com" target="_blank">treehillstudio.com</a></span>';Ext.Msg.show({title:_("superboxselect")+" "+SuperBoxSelect.config.version,msg:e,buttons:Ext.Msg.OK,cls:"treehillstudio_window",width:330})})}}}],listeners:{afterrender:{fn:this.inputOptionsAfterRender,scope:this}}}),SuperBoxSelect.panel.InputOptions.superclass.constructor.call(this,e)},Ext.extend(SuperBoxSelect.panel.InputOptions,MODx.Panel,{selectType:function(e,t){var o=Ext.getCmp("modx-input-props").getEl().select(".alltypes");o&&o.each(function(e){e.setStyle("height","0")});var n=Ext.getCmp("type_"+t.id);n&&n.getEl().setStyle("height",null)},inputOptionsAfterRender:function(){var e=Ext.getCmp("inopt_selectType").getValue();if(e){var t=Ext.getCmp("type_"+e);t&&t.getEl().setStyle("height",null)}var o=Ext.getCmp("modx-tv-elements");o&&o.itemCt.applyStyles({height:"0",overflow:"hidden"})},markDirty:function(){Ext.getCmp("modx-panel-tv").markDirty()}}),Ext.reg("superboxselect-panel-inputoptions",SuperBoxSelect.panel.InputOptions),SuperBoxSelect.combo.SuperBoxSelectTV=function(e){e=e||{},this.options=e.options,this.params=e.params,this.tvid=this.options.tvid,this.maxElements=this.options.maxElements,Ext.applyIf(e,{addNewDataOnBlur:!1,allowBlank:this.options.allowBlank,anchor:"100%",classField:"cls",ctCls:"superboxselect-tv",displayField:"title",displayFieldTpl:this.options.fieldTpl,fieldLabel:this.options.fieldLabel,listeners:{afterrender:{fn:this.afterrender,scope:this},beforeadditem:{fn:this.beforeadditem,scope:this},additem:{fn:this.additem,scope:this},removeitem:{fn:this.removeitem,scope:this}},minChars:2,mode:"remote",msgTarget:"title",name:"tv"+this.tvid+"[]",pageSize:this.options.pageSize,stackItems:this.options.stackItems,queryDelay:0,store:this.options.store,styleField:"style",tpl:'<tpl for="."><div class="x-combo-list-item">'+this.options.fieldTpl+"</div></tpl>",transform:"superboxselect-tv-"+this.tvid,triggerAction:"all",value:this.options.value,valueField:"id",width:400}),SuperBoxSelect.combo.SuperBoxSelectTV.superclass.constructor.call(this,e)},SuperBoxSelect.combo.SuperBoxSelectTV=Ext.extend(SuperBoxSelect.combo.SuperBoxSelectTV,Ext.ux.form.SuperBoxSelect,{afterrender:function(){if(this.maxElements){var e=Ext.get("tv"+this.tvid+"-caption"),t=_("superboxselect.maxElements_label").replace("{maxElements}",this.maxElements);e.dom.innerHTML=e.dom.innerHTML+' <span class="modx-tv-label-description">('+t+")</span>"}var n=this,o=document.querySelectorAll("#"+this.outerWrapEl.id+" ul")[0];o?(o.setAttribute("data-xcomponentid",this.id),new Sortable(o,{onEnd:function(e){if(e.currentTarget){var t=e.currentTarget.getAttribute("data-xcomponentid"),o=Ext.getCmp(t);o?(n.refreshSorting(o),MODx.fireResourceFormChange()):console.log("Unable to reference xComponentContext.")}}})):console.log("Unable to find select element")},beforeadditem:function(e){if(this.maxElements)return!(e.getCount()>this.maxElements-1)||(MODx.msg.alert(_("error"),_("superboxselect.maxElements_msg")),!1)},additem:function(){MODx.fireResourceFormChange()},removeitem:function(){MODx.fireResourceFormChange()},refreshSorting:function(e){function i(e){return Array.prototype.slice.call(e.parentElement.children).indexOf(e)}function s(e,t){for(var o=0;o<t.length;o+=1)if(t[o].value===e)return t[o]}var t,o=e.items.items,n=document.querySelectorAll("#"+e.outerWrapEl.dom.id+" .x-superboxselect-input"),r=function(e,t){if(void 0!==e.el.dom&&void 0!==t.el.dom){var o=i(e.el.dom),n=i(t.el.dom);if(o<n)return-1;if(n<o)return 1}return 0};o.sort(r),t instanceof Function&&t(),function(e,t,o){var n=t[0].parentElement;if(!n)return console.debug("syncElementsByValue(), Unable to reference list root element.");for(var i=0;i<e.length;i+=1){var r=e[i],l=s(String(r.value),t),a=t[i];void 0!==l&&void 0!==a&&n.insertBefore(l,a)}o instanceof Function&&o()}(o,n[0].children),e.value=e.getValue()},getElementComponentContext:function(e){var t=Array.prototype.slice.call(e.classList);return"body"!==e.tagName?null:t.indexOf("x-superboxselect")?e:void getElementComponentContext(e.parentElement)}}),Ext.reg("superboxselect-combo-superboxselectv",SuperBoxSelect.combo.SuperBoxSelectTV),SuperBoxSelect.combo.SuperBoxSelectTVSingle=function(e){e=e||{},this.options=e.options,this.params=e.params,this.tvid=this.options.tvid,Ext.applyIf(e,{allowBlank:this.options.allowBlank,anchor:"100%",ctCls:"superboxselect-tv",displayField:"title",fieldLabel:this.options.fieldLabel,hiddenName:"tv"+this.tvid,minChars:2,mode:"remote",msgTarget:"title",name:"tv"+this.tvid,pageSize:this.options.pageSize,queryDelay:0,store:this.options.store,tpl:'<tpl for="."><div class="x-combo-list-item">'+this.options.fieldTpl+"</div></tpl>",transform:"superboxselect-tv-"+this.tvid,triggerAction:"all",value:this.options.value,valueField:"id",width:400}),SuperBoxSelect.combo.SuperBoxSelectTVSingle.superclass.constructor.call(this,e)},SuperBoxSelect.combo.SuperBoxSelectTVSingle=Ext.extend(SuperBoxSelect.combo.SuperBoxSelectTVSingle,Ext.form.ComboBox),Ext.reg("superboxselect-combo-superboxselectv-single",SuperBoxSelect.combo.SuperBoxSelectTVSingle),SuperBoxSelectTV.Renderer=function(e){return e.length,""};